<form ng-show="editing.current[1]">
	<textarea class="form-control" rows="{{editing.current[0].title.length/80}}" ng-model="title" ng-keyup="logTitle()"></textarea>
	<br>
	<div class="input-group">
		<input class="form-control" type="text" placeholder="Link" ng-model="link">
		<span class="input-group-btn">
			<button class="btn btn-primary" ng-click="save()">Save</button>
			<button class="btn btn-default" ng-click="reset()">Cancel</button>
		</span>
	</div>
	<br>
	<p class="text-primary">
		<span class="glyphicon glyphicon-thumbs-up" ng-class="{voted:isUpvoted(post)}" ng-click="like_unlike(editing.current[0])"></span>
			{{editing.current[0].usersLiked.length}} &nbsp;
		<span class="glyphicon glyphicon-thumbs-down" ng-class="{voted:isDownvoted(post)}" ng-click="dislike_undislike(editing.current[0])"></span>
			{{editing.current[0].usersDisliked.length}} &nbsp;
		<a ng-href="/#/posts/{{editing.current[0]._id}}" class="text-primary">
			<span ng-if="editing.current[0].comments.length==0">Be the first to comment</span>
			<span ng-if="editing.current[0].comments.length==1">1 comment</span>
			<span ng-if="editing.current[0].comments.length>1">{{ editing.current[0].comments.length + ' comments' }}</span>
		</a>
		<span class="pull-right small" ng-show="post.canEditAndDelete && editing.current[0].author===currentUser()">
			<a href="" ng-click="edit(post)">Edit</a> &nbsp;&nbsp; <a href="" ng-click="delete(post)">Delete</a>
		</span>
	</p>
	<hr>
</form>

<p ng-show="posts.length==0">Nothing to show.</p>
<div ng-show="posts.length>0" ng-repeat="post in posts | orderBy: '-points'" class="post text-primary" ng-mouseover="post.canEditAndDelete=true" ng-mouseleave="post.canEditAndDelete=false">
	<p ng-show="editing.current[0]._id!==post._id">
		<a ng-href="{{post.link | link}}" ng-show="post.link" class="text-primary post" target="_blank">
			{{post.title}}
		</a>
		<span ng-hide="post.link" class="text-only">{{post.title}}</span>
		&nbsp;
	</p>
	
	<p ng-show="editing.current[0]._id!==post._id">
		<span class="small">
			<span class="text-muted">by</span> 
			<span ng-if="post.author!==currentUser()" class="small"><a ng-href="/#/users/{{post.author}}">{{post.author}}</a></span>
			<span ng-if="post.author===currentUser()" class="small"><a ng-href="/#/users/{{currentUser()}}">you</a></span>
		</span>
		<span class="text-muted small">at {{post.date | date: 'HH:mm - MMM dd, yyyy'}}</span>
	</p>
	<p ng-show="editing.current[0]._id!==post._id">
		<span>{{post.points}} points</span> &nbsp;
		<span class="glyphicon glyphicon-thumbs-up" tooltip="{{likeTooltipText(post)}}" ng-click="like_unlike(post)"></span>
			{{post.usersLiked.length}} &nbsp;
		<span class="glyphicon glyphicon-thumbs-down" tooltip="{{dislikeTooltipText(post)}}" ng-click="dislike_undislike(post)"></span>
			{{post.usersDisliked.length}} &nbsp;
		<a ng-href="/#/posts/{{post._id}}" class="text-primary">
			<span ng-if="post.comments.length==0">Be the first to comment</span>
			<span ng-if="post.comments.length==1">1 comment</span>
			<span ng-if="post.comments.length>1">{{ post.comments.length + ' comments' }}</span>
		</a>
		<span class="pull-right small" ng-if="post.canEditAndDelete && post.author===currentUser()">
			<a href="" ng-click="edit(post)">Edit</a> &nbsp;&nbsp; <a href="" ng-click="delete(post)">Delete</a>
		</span>
	</p>
	<hr ng-show="editing.current[0]._id!==post._id">
</div>